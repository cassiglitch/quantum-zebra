<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ninjago Platform Fighter</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: #f0f0f0;
        }

        canvas {
            display: block;
            margin: auto;
            border: 1px solid #000;
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas" width="800" height="600"></canvas>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        // Define ninja powers
        const ninjaPowers = {
            "Kai": "Fire",
            "Jay": "Lightning",
            "Cole": "Earth",
            "Zane": "Ice",
            "Lloyd": "Energy",
            "Nya": "Water",
            "Morro": "Wind"
        };

        // Define move attributes for each move
        const moveAttributes = {
            "Fire Spin": { damage: 20, range: 50, cooldown: 2000, endLag: 500 },
            "Fireball": { damage: 30, range: 100, cooldown: 3000, endLag: 600 },
            "Dragon Kick": { damage: 40, range: 30, cooldown: 4000, endLag: 700 },
            // Define attributes for other moves here
        };

        // Define character attributes
        const characterAttributes = {
            "Kai": { weight: 80, speed: 7 },
            "Jay": { weight: 75, speed: 8 },
            "Cole": { weight: 90, speed: 6 },
            "Zane": { weight: 70, speed: 9 },
            "Lloyd": { weight: 85, speed: 7 },
            "Nya": { weight: 75, speed: 8 },
            "Morro": { weight: 80, speed: 7 }
        };

        // Player object
        const player = {
            x: 50,
            y: canvas.height - 150,
            width: 50,
            height: 50,
            color: '#ff0000',
            speedX: 0,
            speedY: 0,
            acceleration: 0.5,
            maxSpeed: 5,
            weight: null, // Will be assigned based on selection
            power: null, // Will be assigned based on selection
            moveset: null, // Will be assigned based on selection
            isAttacking: false,
            isPossessed: false,
            currentMove: null,
            moveCooldown: 0,
            endLag: 0,
            damage: 0,
            maxDamage: 999,
            knockback: 0
        };

        // Enemy object
        const enemy = {
            x: canvas.width - 100,
            y: canvas.height - 150,
            width: 50,
            height: 50,
            color: '#00ff00',
            speedX: 0,
            speedY: 0,
            acceleration: 0.5,
            maxSpeed: 5,
            weight: null, // Will be assigned based on selection
            power: null, // Will be assigned based on selection
            moveset: null, // Will be assigned based on selection
            isAttacking: false,
            isPossessed: false,
            currentMove: null,
            moveCooldown: 0,
            endLag: 0,
            damage: 0,
            maxDamage: 999,
            knockback: 0
        };

        // Spinjitzu object
        const spinjitzu = {
            x: 0,
            y: 0,
            radius: 50,
            color: 'rgba(255, 165, 0, 0.5)',
            active: false,
            duration: 3000, // Duration in milliseconds
            startTime: 0
        };

        // Unlock Morro
        let unlockedMorro = false;

        // Player object for Morro
        const morroPlayer = {
            x: 50,
            y: canvas.height - 150,
            width: 50,
            height: 50,
            color: '#800080', // Purple color for Morro
            speedX: 0,
            speedY: 0,
            acceleration: 0.5,
            maxSpeed: 5,
            weight: 80,
            power: ninjaPowers["Morro"], // Morro's power is Wind
            moveset: moveSets["Morro"],
            isAttacking: false,
            isPossessed: true,
            currentMove: null,
            moveCooldown: 0,
            endLag: 0,
            damage: 0,
            maxDamage: 999,
            knockback: 0
        };

        // Select screen
        function selectScreen() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.font = "30px Arial";
            ctx.fillStyle = "black";
            ctx.fillText("Select Your Ninja:", canvas.width / 2 - 150, 50);

            let y = 100;
            for (const ninja in ninjaPowers) {
                ctx.fillText(ninja, canvas.width / 2 - 50, y);
                y += 50;
            }
        }

        // Event listener for select screen
        let selectedNinja = null;
        document.addEventListener('click', (event) => {
            const rect = canvas.getBoundingClientRect();
            const mouseX = event.clientX - rect.left;
            const mouseY = event.clientY - rect.top;

            let y = 100;
            for (const ninja in ninjaPowers) {
                if (mouseX > canvas.width / 2 - 50 && mouseX < canvas.width / 2 + 50 && mouseY > y - 30 && mouseY < y) {
                    selectedNinja = ninja;
                    break;
                }
                y += 50;
            }

            if (selectedNinja) {
                console.log(`Selected Ninja: ${selectedNinja}`);
                startGame();
            }
        });

        // Start game function
        function startGame() {
            console.log("Game started!");
            // Initialize player and enemy positions
            player.x = 50;
            enemy.x = canvas.width - 100;

            // Assign powers, movesets, weight, and speed based on selection
            player.power = ninjaPowers[selectedNinja];
            player.moveset = moveSets[selectedNinja];
            player.weight = characterAttributes[selectedNinja].weight;

            enemy.power = ninjaPowers[selectedNinja === "Morro" ? "Lloyd" : selectedNinja
            ];
            enemy.moveset = moveSets[selectedNinja === "Morro" ? "Lloyd" : selectedNinja];
            enemy.weight = characterAttributes[selectedNinja === "Morro" ? "Lloyd" : selectedNinja].weight;
        }

        // Handle player movement
        function handlePlayerMovement() {
            // Horizontal movement
            if (keyState['ArrowLeft']) {
                player.speedX = -player.maxSpeed;
            } else if (keyState['ArrowRight']) {
                player.speedX = player.maxSpeed;
            } else {
                player.speedX = 0;
            }

            // Vertical movement (for jumping)
            if (keyState['ArrowUp'] && player.y === canvas.height - player.height) {
                player.speedY = -10; // Jumping velocity
            }

            // Apply acceleration and limit speed
            player.speedX += player.acceleration;
            player.speedX = Math.min(Math.max(player.speedX, -player.maxSpeed), player.maxSpeed);

            // Apply speed to position
            player.x += player.speedX;
            player.y += player.speedY;

            // Apply gravity
            player.speedY += 0.5;
            player.speedY = Math.min(player.speedY, 10); // Terminal velocity
        }

        // Handle enemy movement (AI)
        function handleEnemyMovement() {
            // Implement enemy movement logic here
        }

        // Event listeners for player controls
        const keyState = {};
        document.addEventListener('keydown', (event) => {
            keyState[event.key] = true;
        });

        document.addEventListener('keyup', (event) => {
            keyState[event.key] = false;
        });

        // Update game objects
        function update() {
            handlePlayerMovement();
            handleEnemyMovement();
            // Implement other updates here
        }

        // Render game objects
        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            // Implement drawing logic here
        }

        // Game loop
        function gameLoop() {
            update();
            draw();
            requestAnimationFrame(gameLoop);
        }

        // Start the game loop
        gameLoop();
    </script>
</body>
</html>
