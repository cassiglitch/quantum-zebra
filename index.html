<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Super Tic Tac Toe</title>
<style>
  body {
    font-family: Arial, sans-serif;
    text-align: center;
  }
  
  .board {
    display: inline-grid;
    grid-template-columns: repeat(9, 40px);
    grid-gap: 2px;
    margin-bottom: 20px;
  }
  
  .cell {
    width: 40px;
    height: 40px;
    background-color: #ddd;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5em;
    cursor: pointer;
  }
  
  .message {
    font-size: 1.2em;
    margin-top: 10px;
  }
  
  button {
    font-size: 1em;
    padding: 10px 20px;
    cursor: pointer;
  }
</style>
</head>
<body>
<h1>Super Tic Tac Toe</h1>
<div id="boards" class="board">
  <!-- Outer grid -->
  <!-- Individual Tic Tac Toe boards will be dynamically generated here -->
</div>
<button id="resetButton">Reset</button>
<div id="message" class="message"></div>

<script>
  const boardsContainer = document.getElementById('boards');
  const resetButton = document.getElementById('resetButton');
  const message = document.getElementById('message');

  // Create the super Tic Tac Toe boards
  for (let i = 0; i < 9; i++) {
    const board = document.createElement('div');
    board.classList.add('board');
    for (let j = 0; j < 9; j++) {
      const cell = document.createElement('div');
      cell.classList.add('cell');
      cell.dataset.boardIndex = i;
      cell.dataset.cellIndex = j;
      cell.addEventListener('click', makeMove);
      board.appendChild(cell);
    }
    boardsContainer.appendChild(board);
  }

  let currentPlayer = 'X';
  let gameEnded = false;
  let boardStates = Array(9).fill().map(() => Array(9).fill(''));

  const winningCombos = [
    // Rows
    [0, 1, 2], [3, 4, 5], [6, 7, 8],
    [9, 10, 11], [12, 13, 14], [15, 16, 17],
    [18, 19, 20], [21, 22, 23], [24, 25, 26],
    // Columns
    [0, 3, 6], [1, 4, 7], [2, 5, 8],
    [9, 12, 15], [10, 13, 16], [11, 14, 17],
    [18, 21, 24], [19, 22, 25], [20, 23, 26],
    // Diagonals
    [0, 4, 8], [2, 4, 6],
    [9, 13, 17], [11, 13, 15],
    [18, 22, 26], [20, 22, 24]
  ];

  function makeMove(event) {
    if (gameEnded) return;

    const boardIndex = parseInt(event.target.dataset.boardIndex);
    const cellIndex = parseInt(event.target.dataset.cellIndex);

    if (boardStates[boardIndex][cellIndex] === '') {
      boardStates[boardIndex][cellIndex] = currentPlayer;
      event.target.innerText = currentPlayer;
      
      // Check for a win on the current board
      if (checkWin(boardStates[boardIndex])) {
        // Mark the winning board
        boardsContainer.children[boardIndex].classList.add('winner');
      } else if (checkDraw(boardStates[boardIndex])) {
        // If the board is full but no winner, mark it as a draw
        boardsContainer.children[boardIndex].classList.add('draw');
      }

      // Check for a win on the overall board
      if (checkWin(boardStates) !== '') {
        message.innerText = `${currentPlayer} wins the game!`;
        gameEnded = true;
      } else if (checkDraw(boardStates)) {
        message.innerText = 'It\'s a draw!';
        gameEnded = true;
      } else {
        currentPlayer = currentPlayer === 'X' ? 'O' : 'X';
        message.innerText = `Player ${currentPlayer}'s turn`;
      }
    }
  }

  function checkWin(board) {
    return winningCombos.some(combo => {
      return combo.every(index => {
        return board[index] === currentPlayer;
      });
    });
  }

  function checkDraw(board) {
    return board.every(cell => {
      return cell !== '';
    });
  }

  function reset() {
    currentPlayer = 'X';
    gameEnded = false;
    boardStates = Array(9).fill().map(() => Array(9).fill(''));
    message.innerText = `Player ${currentPlayer}'s turn`;
    boardsContainer.querySelectorAll('.board').forEach(board => {
      board.querySelectorAll('.cell').forEach(cell => {
        cell.innerText = '';
        cell.classList.remove('winner', 'draw');
      });
    });
  }

  resetButton.addEventListener('click', reset);
</script>
</body>
</html>
